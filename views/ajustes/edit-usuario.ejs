<!DOCTYPE html>
<html lang="en">
	<%- include ('../partials/head-edits.ejs') %>
	<body>
		<div class="sidebar scrollmenu">
			<div class="container mb-3 mt-3">
				<img src="/img/golflogo.png" class="logo" alt="" />
			</div>
			<a href="/index"><i class="bi bi-house-check"></i> Inicio <i class="bi bi-chevron-right flecha"></i></a>
			<a href="/tarifas"><i class="bi bi-currency-dollar"></i> Tarifas <i class="bi bi-chevron-right flecha"></i></a>
			<a href="/guias"> <i class="bi bi-journal-text"></i> Guías <i class="bi bi-chevron-right flecha"></i></a>
			<a href="/opera"> <i class="bi bi-upc-scan"></i> CÓD. OPERA <i class="bi bi-chevron-right flecha"></i></a>
			<a href="/minigolf"> <i class="bi bi-houses"></i> MINI GOLF <i class="bi bi-chevron-right flecha"></i></a>
			<% if(logged.rol === "Admin"){ %>
			<a class="d-block active" href="/ajustes"><i class="bi bi-gear"></i> AJUSTES <i class="bi bi-chevron-right flecha"></i></a>
			<% } else { %>
			<a class="d-none" href="/ajustes">AJUSTES <i class="bi bi-chevron-right flecha"></i></a>
			<% } %>
		</div>

		<!-- NAV LG -->
		<nav class="navbar fixed-top navi">
			<div class="container-fluid">
				<span class="navbar-brand mb-0 h1" id="navbarLG">AJUSTES - USUARIOS</span>
				<div class="btn-group dropstart">
					<% if(logged.rol === "Admin"){ %>
					<a class="btn btn-success dropdown-toggle btnShadow" role="button" data-bs-toggle="dropdown" aria-expanded="false">
						<span class="text-light"><i class="bi bi-person-fill"></i> <%= logged.username %></span>
					</a>
					<% } else { %>
					<a class="btn btn-warning dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
						<span class="text-dark"><i class="bi bi-person-fill"></i> <%= logged.username %></span>
					</a>
					<% } %>
					<ul class="dropdown-menu">
						<li><a class="dropdown-item" href="/edit-usuario-actual">Editar</a></li>
						<li><a class="dropdown-item" href="/logout">Salir</a></li>
					</ul>
				</div>
			</div>
		</nav>

		<!-- NAV SM -->
		<nav class="navbar navSmall fixed-top">
			<div class="container-fluid">
				<a class="navbar-brand" href="/index"><i class="bi bi-house-up" id="titulo"></i></a>
				<span class="text-uppercase text-light" id="navbarSM"></span>
				<!-- OFFCANVAS -->
				<button
					class="navbar-toggler navbar-dark"
					type="button"
					data-bs-toggle="offcanvas"
					data-bs-target="#offcanvasWithBothOptions"
					aria-controls="offcanvasWithBothOptions">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div
					class="offcanvas offcanvas-start new_sidenav"
					data-bs-scroll="true"
					tabindex="-1"
					id="offcanvasWithBothOptions"
					aria-labelledby="offcanvasWithBothOptionsLabel">
					<div class="offcanvas-header">
						<div class="offcanvas-title" id="offcanvasWithBothOptionsLabel">
							<div class="dropdown btn-perfil">
								<% if(user.rol === "Admin"){ %>
								<button class="btn btn-success dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
									<span class="text-light text-uppercase"><i class="bi bi-person-gear"></i>&nbsp;<%= user.username %></span>
								</button>
								<% } else { %>
								<button class="btn btn-warning btn-sm dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
									<span class="text-dark text-uppercase"><%= user.username %></span>
								</button>
								<% } %>
								<ul class="dropdown-menu">
									<li><a class="dropdown-item text-dark" href="/edit-usuario-actual">Editar</a></li>
									<li><a class="dropdown-item text-dark" href="/logout">Salir</a></li>
								</ul>
							</div>
						</div>
						<div data-bs-theme="dark">
							<button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
						</div>
					</div>
					<div class="offcanvas-body">
						<div class="mt-3">
							<a class="nav-link" href="/index"><i class="bi bi-house-check"></i>&nbsp; Inicio</a>
							<a class="nav-link" href="/tarifas"><i class="bi bi-currency-dollar"></i>&nbsp; Tarifas</a>
							<a class="nav-link" href="/guias"><i class="bi bi-journal-text"></i>&nbsp; GUÍAS</a>
							<a class="nav-link" href="/opera"><i class="bi bi-upc-scan"></i>&nbsp; CÓDIGOS OPERA</a>
							<a class="nav-link" href="/minigolf"><i class="bi bi-houses"></i>&nbsp; MINI GOLF</a>
							<% if(user.rol === "Admin"){ %>
							<a class="d-block active" href="/ajustes"><i class="bi bi-gear"></i>&nbsp; AJUSTES </a>
							<% } else { %>
							<a class="d-none" href="/ajustes">AJUSTES </a>
							<% } %>
						</div>
					</div>
					<div class="offcanvas-footer text-light text-center">
						<hr />
						<h5 class="text-uppercase">Guía Hard Rock Golf</h5>
					</div>
				</div>
				<!-- OFFCANVAS -->
			</div>
		</nav>

		<div class="content">
			<div id="Servicios" class="afterNav">
				<div class="text-center">
					<h4 class="text-uppercase" id="titulo">Editar Usuario</h4>
				</div>
				<div class="cardEdit-container">
					<div class="card">
						<div class="card-body">
							<% if (typeof errorMessage !== "undefined") { %>
							<div class="alert alert-danger alert-dismissible fade show btnShadow text-center" role="alert">
								<i class="bi bi-exclamation-triangle"></i> <%= errorMessage %><button
									type="button"
									class="btn-close"
									data-bs-dismiss="alert"
									aria-label="Close"></button>
							</div>
							<% } %> <% if (user) { %>

							<form id="edit_form" action="/ajustes/edit-usuario/<%= user.id %>" method="POST">
								<div class="row row-cols-1 row-cols-sm-2">
									<div class="col">
										<div class="form-floating mb-3">
											<input type="text" class="form-control" name="nombre" value="<%= user.nombre %>" />
											<label for="userName" class="form-label">Nombre</label>
										</div>
									</div>
									<div class="col">
										<div class="form-floating mb-3">
											<input type="text" class="form-control" name="username" value="<%= user.username %>" />
											<label for="userNickname" class="form-label">Nombre de usuario</label>
										</div>
									</div>
								</div>
								<div class="row row-cols-1 row-cols-sm-2">
									<div class="col">
										<div class="form-floating mb-3" id="rolEdit">
											<select class="form-select" name="rol" aria-label="role-selector">
												<% if(user.rol === "Admin"){ %>
												<option selected value="Admin">Admin</option>
												<option value="User">User</option>
												<% } else { %>
												<option value="Admin">Admin</option>
												<option selected value="User">User</option>
												<% } %>
											</select>
											<label for="userRole" class="form-label">Rol</label>
										</div>
									</div>
									<div class="col">
										<div class="form-floating mb-3" id="passEdit">
											<input type="password" class="form-control" name="old_password" id="old_password" placeholder="Contraseña actual" />
											<label for="userActPass" class="form-label">Contraseña actual</label>
										</div>
									</div>
								</div>
								<div class="row row-cols-1 row-cols-sm-2">
									<div class="col">
										<div class="form-floating mb-3">
											<input
												type="password"
												class="form-control"
												name="password"
												id="password"
												placeholder="Escriba la Contraseña"
												onkeyup="checkPass();" />
											<label for="userPass" class="form-label">Contraseña nueva</label>
										</div>
									</div>
									<div class="col">
										<div class="form-floating mb-3">
											<input
												type="password"
												class="form-control"
												name="pass_conf"
												id="pass_conf"
												placeholder="Repita la Contraseña"
												onkeyup="checkPass();" />
											<label for="userPass-conf" class="form-label">Repita la Contraseña</label>
										</div>
									</div>
								</div>
								<p id="message" class="text-center"></p>

								<div class="new-form-button">
									<button type="submit" class="btn btn-warning btnAction btnShadow" id="btnEditUserDOS">EDITAR</button>
									<a href="/ajustes/usuarios-conf" class="btn btn-danger btnAction btnShadow">CANCELAR</a>
								</div>
							</form>
							<% } %>
						</div>
					</div>
				</div>
			</div>
			<%- include ('../partials/footer.ejs') %>
		</div>
	</body>
</html>
