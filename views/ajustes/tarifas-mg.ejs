<!DOCTYPE html>
<html lang="en">
	<%- include ('../partials/head-edits.ejs') %>

	<body>
		<% if (user) { %>
		<div class="sidebar scrollmenu">
			<div class="container mb-3 mt-3">
				<img src="/img/golflogo.png" class="logo" alt="" />
			</div>
			<a href="/index"><i class="bi bi-house-check"></i> Inicio <i class="bi bi-chevron-right flecha"></i></a>
			<a href="/tarifas"><i class="bi bi-currency-dollar"></i> Tarifas <i class="bi bi-chevron-right flecha"></i></a>
			<a href="/guias"><i class="bi bi-journal-text"></i> Guías <i class="bi bi-chevron-right flecha"></i></a>
			<a href="/opera"><i class="bi bi-upc-scan"></i> CÓD. OPERA <i class="bi bi-chevron-right flecha"></i></a>
			<a href="/minigolf"><i class="bi bi-houses"></i> MINI GOLF <i class="bi bi-chevron-right flecha"></i></a>
			<% if(user.rol === "Admin"){ %>
			<a class="d-block active" href="/ajustes"><i class="bi bi-gear"></i> AJUSTES <i class="bi bi-chevron-right flecha"></i></a>
			<% } else { %>
			<a class="d-none" href="/ajustes">AJUSTES <i class="bi bi-chevron-right flecha"></i></a>
			<% } %>
		</div>

		<!-- NAV LG -->
		<nav class="navbar fixed-top navi">
			<div class="container-fluid">
				<span class="navbar-brand mb-0 h1" id="navbarLG">AJUSTES - TARIFAS MINIGOLF</span>
				<div class="btn-group dropstart">
					<% if(user.rol === "Admin"){ %>
					<a class="btn btn-success dropdown-toggle btnShadow" role="button" data-bs-toggle="dropdown" aria-expanded="false">
						<span class="text-light"><i class="bi bi-person-fill"></i> <%= user.username %></span>
					</a>
					<% } else { %>
					<a class="btn btn-warning dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
						<span class="text-dark"><i class="bi bi-person-fill"></i> <%= user.username %></span>
					</a>
					<% } %>
					<ul class="dropdown-menu">
						<li><a class="dropdown-item" href="/edit-usuario-actual">Editar</a></li>
						<li><a class="dropdown-item" href="/logout">Salir</a></li>
					</ul>
				</div>
			</div>
		</nav>

		<!-- NAV SM -->
		<nav class="navbar navSmall fixed-top">
			<div class="container-fluid">
				<a class="navbar-brand" href="/index"><i class="bi bi-house-up" id="titulo"></i></a>
				<span class="text-uppercase text-light" id="navbarSM"></span>
				<button
					class="navbar-toggler navbar-dark"
					data-bs-toggle="collapse"
					data-bs-target="#navbarText"
					aria-controls="navbarText"
					aria-expanded="false"
					aria-label="Toggle navigation"
					onclick="openNav()">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div id="mySidenav" class="sidenav">
					<div id="main">
						<div class="dropdown btn-perfil">
							<% if(user.rol === "Admin"){ %>
							<button class="btn btn-success dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
								<span class="text-light text-uppercase"><%= user.username %></span>
							</button>
							<% } else { %>
							<button class="btn btn-warning btn-sm dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
								<span class="text-dark text-uppercase"><%= user.username %></span>
							</button>
							<% } %>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item text-dark" href="/edit-usuario-actual">Editar</a></li>
								<li>
									<a class="dropdown-item text-dark" href="/logout">Salir</a>
								</li>
							</ul>
						</div>
						<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
						<a class="nav-link" href="/index">Inicio</a>
						<a class="nav-link" href="/tarifas">Tarifas</a>
						<a class="nav-link" href="/guias">GUIAS</a>
						<a class="nav-link" href="/opera">CÓD. OPERA</a>
						<a class="nav-link" href="/minigolf">MINI GOLF</a>
						<% if(user.rol === "Admin"){ %>
						<a class="d-block active" href="/ajustes">AJUSTES </a>
						<% } else { %>
						<a class="d-none" href="/ajustes">AJUSTES </a>
						<% } %>
					</div>
				</div>
			</div>
		</nav>
		<% } %>

		<div class="content">
			<div id="Tarifas" class="afterNav">
				<div class="row d-flex justify-content-between">
					<div class="text-center">
						<h4 class="text-uppercase d-none" id="titulo">AJUSTES - TARIFAS MINIGOLF</h4>
					</div>
					<div class="col-4">
						<a href="/ajustes/new-tarifas-mg" class="btn btn-success btnShadow" id="btnService"> AGREGAR </a>
						<!-- Button trigger modal -->
					</div>
					<div class="col-8" id="inputBuscar"><%- include ('../partials/buscar-conf.ejs') %></div>
				</div>
				<div class="text-center mt-3 mb-2">
					<span>*Seleccione una Tarifa para ver su descripción*</span>
				</div>

				<div class="card mt-3">
					<div class="card-body">
						<% if (message.length > 0) { %>
						<div class="alert alert-success alert-dismissible fade show btnShadow text-center" role="alert">
							<i class="bi bi-check-circle"></i> <%= message %><button
								type="button"
								class="btn-close"
								data-bs-dismiss="alert"
								aria-label="Close"></button>
						</div>
						<% } %>
						<table class="table table-hover" id="myTable">
							<thead>
								<tr>
									<th scope="col" class="col-5 col-xl-3 px-0">Nombre</th>
									<th scope="col" class="col-2 hide-column">Precio</th>
									<th scope="col" class="col hide-column">Opera</th>
									<th scope="col" class="col-4 hide-column">Descripción</th>
									<th scope="col" class="col-2">Acciones</th>
								</tr>
							</thead>
							<tbody>
								<% results.forEach((rate) => { %>
								<tr>
									<td
										class="hide-text info"
										onclick="alert('- <%= rate.nombre %> -\n\n Precio: <% if (rate.precio > Math.floor(rate.precio)) { %><%= rate.precio%>0<% } else if (rate.precio == 0) { %>Resort Cred.<% } else { %><%= rate.precio%>.00<% } %>\n\n Opera: <%= rate.cod_opera %>\n\n <%= rate.descripcion %>')">
										<span class="editCenter"
											><%= rate.nombre %>
											<div class="verInfo">
												-
												<i class="bi bi-info-circle"></i></div
										></span>
									</td>
									<% if (rate.precio > Math.floor(rate.precio)) { %>
									<td class="hide-column">
										<%= rate.precio%>0
										<div class="verInfo hide-column">
											- Ver Info
											<i class="bi bi-info-circle"></i>
										</div>
									</td>
									<% } else if (rate.precio == 0) { %>
									<td class="hide-column">
										Resort Cred.
										<div class="verInfo hide-column">
											- Ver Info
											<i class="bi bi-info-circle"></i>
										</div>
									</td>
									<% } else { %>
									<td class="hide-column">
										<%= rate.precio%>.00
										<div class="verInfo hide-column">
											- Ver Info
											<i class="bi bi-info-circle"></i>
										</div>
									</td>
									<% } %>
									<td class="hide-column"><%= rate.cod_opera%></td>
									<td class="hide-column hide-text"><span><%= rate.descripcion %></span></td>

									<td class="d-flex justify-content-between">
										<a
											href="/ajustes/edit-tarifa-mg/<%= rate.id %>"
											data-bs-toggle="#"
											data-bs-target="#rateUpdate"
											class="btn btn-sm btn-warning btnAction btnShadow"
											><i class="bi bi-pencil"></i
										></a>

										<a
											href="/ajustes/tarifas-mg/deleteRateMg/<%= rate.id %>"
											class="btn btn-sm btn-danger btnAction btnShadow"
											onclick="return confirm_delete()"
											><i class="bi bi-trash"></i
										></a>
									</td>
								</tr>
								<% }) %>
							</tbody>
						</table>
						<div class="text-center" id="noResults">
							<img class="noResults" src="/img/noResults.PNG" alt="" />
							<h4 class="text-uppercase mt-3">No hay resultados</h4>
						</div>
					</div>
				</div>
			</div>

			<%- include ('../partials/footer.ejs') %>
		</div>
	</body>
</html>
